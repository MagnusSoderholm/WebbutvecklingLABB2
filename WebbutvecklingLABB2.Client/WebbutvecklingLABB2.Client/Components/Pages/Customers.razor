@page "/customers"
@using WebbutvecklingLABB2.Shared.Models
@using WebbutvecklingLABB2.Client.Services
@inject ApiService ApiService
@inject NavigationManager NavigationManager

<h3>Kundlista</h3>

<button class="btn btn-primary mb-3" @onclick="NavigateToRegister">Registrera ny kund</button>

@if (customers == null)
{
    <p>Laddar...</p>
}
else
{
    @foreach (var customer in customers)
    {
        <div class="customer-card mb-3 border p-3 rounded shadow-sm">
            <h4>@customer.FirstName @customer.LastName</h4>
            <p><strong>Email:</strong> @customer.Email</p>
            <p><strong>Telefon:</strong> @customer.PhoneNumber</p>
            <p><strong>Adress:</strong> @customer.Address</p>

            <button class="btn btn-sm btn-warning" @onclick="() => EditCustomer(customer.Id)">Redigera</button>
        </div>
    }
}

@code {
    private List<Customer> customers;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            customers = await ApiService.GetCustomersAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error fetching customers: {ex.Message}");
        }
    }

    private void NavigateToRegister()
    {
        NavigationManager.NavigateTo("/register-customer");
    }

    private void EditCustomer(int id)
    {
        NavigationManager.NavigateTo($"/customers/edit/{id}");
    }
}